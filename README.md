# SSH Publisher

IntelliJ IDEA SSH 客户端插件，支持 SSH 连接管理、终端操作、文件系统浏览和文件传输管理。

## 功能特性

### SSH 连接管理
- 密码和密钥两种认证方式
- 支持使用本地默认密钥（~/.ssh/id_rsa）
- 支持从文件选择器加载任意密钥文件（PEM/二进制格式）
- 连接测试
- 心跳保活，防止超时断开
- 前置/后置脚本配置（列表+编辑器方式，方便编辑）
- 配置导出/导入（支持全部导出或选择性导出）

### SSH 终端
- 基于 JediTerm 终端模拟器
- 自动适配 IDEA 主题颜色
- 中文字体支持
- 多终端标签页
- Tab 拖拽排序
- Tab 右键分屏（向右/向下拆分）
- 底部系统监控状态栏（CPU/内存/磁盘/进程数，每5秒刷新）

### 文件系统 (SFTP)
- 远程文件浏览器
- 文件/文件夹上传下载
- 新建文件夹、新建文件
- 重命名、删除
- 双击文件在 IDEA 编辑器中打开编辑
- 编辑保存后自动同步到远程服务器（带通知提示）
- 连接断开时自动重连
- 支持 IDEA 本地历史记录
- 文件属性查看（大小、权限、修改时间）
- 快速搜索定位
- 懒加载目录（展开时加载）
- 下载文件时检测重名，支持覆盖/重命名/取消
- 关闭文件系统 Tab 时自动关闭所有打开的远程文件编辑器
- 底部系统监控状态栏（CPU/内存/磁盘/进程数，每5秒刷新）

### 传输管理
- 统一管理上传和下载任务
- 每个任务使用独立 SSH 连接（不影响终端和文件系统）
- 任务队列管理（进度显示、停止、重试、删除）
- 停止上传任务时自动删除远程未完成文件
- 停止下载任务时自动删除本地未完成文件
- 任务详情查看（前置脚本、后置脚本、执行日志）
- 批量停止、清除已完成任务

### 文件上传
- 单服务器上传
- 批量上传（多文件上传到多台服务器）
  - 每个文件可独立配置目标服务器
  - 每个文件可独立配置远程路径和文件名
  - 每个文件可独立配置前置/后置脚本
  - 支持临时脚本
- 自定义远程文件名
- 前置/后置脚本执行

### 配置管理
- 导出配置（全部导出或选择性导出）
- 导入配置（支持覆盖或跳过已存在配置）
- 刷新后保持展开状态

## 界面布局

```
┌─────────────────────────────────────────────────┐
│ 工具栏: 新建配置 | 批量上传 | 刷新 | 展开/折叠   │
├──────────────┬──────────────────────────────────┤
│ SSH连接列表  │  终端/文件系统 Tab（支持分屏）    │
│ ──────────── │                                  │
│ 传输管理     │                                  │
└──────────────┴──────────────────────────────────┘
```

## 使用说明

### 添加 SSH 连接
1. 点击工具栏「+」按钮
2. 填写名称、主机、端口、用户名
3. 选择认证方式（密码/密钥）
4. 可选配置前置/后置脚本
5. 点击「测试连接」验证

### 打开终端
- 双击 SSH 配置

### 打开文件系统
- 右键 SSH 配置 → 文件系统

### 编辑远程文件
- 在文件系统中双击文件
- 文件下载到本地缓存并在 IDEA 编辑器中打开
- 保存时自动同步到远程服务器（右下角显示通知）
- 连接断开时自动重连后同步
- 支持 IDEA 本地历史记录（Local History）

### 上传文件
- 右键 SSH 配置 → 上传文件
- 或在文件系统面板点击上传按钮
- 任务添加到传输管理队列

### 下载文件
- 在文件系统中选中文件，点击下载按钮
- 或右键文件 → 下载
- 本地存在同名文件时可选择覆盖、重命名或取消
- 任务添加到传输管理队列

### 批量上传
1. 点击工具栏「批量上传」
2. 添加要上传的文件（支持多选）
3. 选择每个文件的目标服务器
4. 配置每个文件的远程路径和文件名
5. 点击服务器配置脚本（可选）
6. 设置临时脚本（可选）
7. 添加到传输队列

### 导出配置
1. 点击工具栏「导出配置」
2. 选择「导出全部」或「选择导出」
3. 选择导出目录
4. 配置导出为 JSON 文件

### 导入配置
1. 点击工具栏「导入配置」
2. 选择配置文件（JSON）
3. 选择覆盖或跳过已存在的配置

### 传输管理
- 查看所有上传/下载任务进度
- 停止：中断任务并清理未完成文件
- 重试：重新执行失败或已停止的任务
- 删除：从列表移除任务
- 详情：查看脚本内容和执行日志

### Tab 分屏
- 右键 Tab → 向右拆分 / 向下拆分
- 右键 Tab → 取消分屏（合并当前分屏区域的所有 Tab）
- 支持无限层级分屏
- 拖拽 Tab 可在同一容器内调整顺序
- 拖拽 Tab 到其他分屏容器可跨容器移动
- 跨容器拖拽时支持指定位置插入（拖到目标 Tab 上方即插入该位置）
- 拖拽时目标容器会高亮显示
- 点击或聚焦某个分屏容器后，新建的终端/文件系统会添加到该容器
- 分屏容器内所有 Tab 关闭后自动与兄弟容器合并

## 依赖

- Apache MINA SSHD
- SQLite JDBC
- JediTerm
- JTools

## License

MIT
