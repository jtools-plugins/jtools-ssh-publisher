# SSH Publisher

一个功能强大的 IntelliJ IDEA SSH 客户端插件，支持 SSH 连接管理、终端操作、文件上传和批量部署功能。

## 功能特性

### SSH 连接管理
- 支持密码和密钥两种认证方式
- 配置分组管理，清晰组织多个服务器
- 连接测试功能，快速验证配置
- 心跳保活机制，防止连接超时断开
- 断线自动检测，支持一键重连

### SSH 终端
- 基于 JediTerm 的专业终端模拟器
- 自动适配 IDEA 主题颜色
- 支持中文显示（自动查找支持中文的字体）
- 多终端标签页管理
- UTF-8 编码支持

### 文件上传 (SFTP)
- **单服务器上传**：选择文件上传到指定服务器
- **批量上传**：同一文件上传到多台服务器
- **上传队列管理**：
  - 实时进度显示
  - 任务状态跟踪（等待/执行中/成功/失败/已停止）
  - 支持停止、重试、删除任务
  - 查看任务详情和执行日志
- 支持自定义远程文件名（解决中文文件名乱码问题）
- **前置/后置脚本**：
  - 每个服务器可配置多个脚本模板
  - 批量上传时可为每个服务器单独选择脚本
  - 支持临时脚本（一次性执行，不保存）
  - 脚本编辑器支持 Shell 语法高亮

## 界面布局

- **左侧面板**：SSH 连接列表 / 上传管理（Tab 切换）
- **右侧面板**：终端标签页

## 数据存储

配置数据使用 SQLite 存储，路径：
```
~/.ssh-publisher/db.data
```

## 使用说明

### 添加 SSH 连接
1. 点击工具栏「+」按钮
2. 填写连接名称、主机、端口、用户名
3. 选择认证方式：
   - **密码认证**：直接输入密码
   - **密钥认证**：粘贴私钥内容，可选填密钥密码
4. 设置默认远程目录
5. 可选配置前置/后置脚本模板
6. 点击「测试连接」验证配置

### 使用终端
- 双击 SSH 配置打开终端
- 支持多个终端同时打开
- 连接断开时显示提示，可点击重新连接

### 单服务器上传
1. 右键点击 SSH 配置，选择「上传文件」
2. 选择本地文件
3. 设置远程目录和文件名
4. 选择需要执行的前置/后置脚本
5. 点击「上传」

### 批量上传（多服务器）
1. 点击工具栏「批量上传」按钮
2. 选择本地文件
3. 勾选目标服务器
4. 点击服务器可配置其前置/后置脚本
5. 可选填写临时脚本（所有服务器执行）
6. 点击「添加到上传队列」
7. 在「上传管理」面板查看进度

### 管理上传任务
- **重新上传**：重试失败或已停止的任务
- **停止**：停止正在执行的任务
- **详情**：查看任务完整信息和执行日志
- **删除**：从队列中移除任务

## 依赖

- Apache MINA SSHD (SSH/SFTP 客户端)
- SQLite JDBC (数据存储)
- JediTerm (终端模拟)

## 构建

```bash
./gradlew buildPlugin
```

构建产物位于 `build/distributions/` 目录。

## 安装

1. 打开 IDEA，进入 `Settings` → `Plugins`
2. 点击齿轮图标，选择 `Install Plugin from Disk...`
3. 选择构建的 zip 文件

## License

MIT
