# JTools SSH Publisher

一个功能强大的 JTools SSH 客户端插件，支持 SSH 连接管理、终端操作和多文件并行上传功能。

## 功能特性

### SSH 连接管理
- 支持密码和密钥两种认证方式
- 配置分组管理，清晰组织多个服务器
- 连接测试功能，快速验证配置
- 配置复制/编辑/删除操作
- 心跳保活机制，防止连接超时断开
- 断线自动检测，支持一键重连

### SSH 终端
- 基于 JediTerm 的专业终端模拟器
- 自动适配 IDEA 主题颜色
- 支持常用快捷键（Ctrl+C/V、Tab 等）
- 多终端标签页管理
- UTF-8 编码支持

### 文件上传 (SFTP)
- **多文件并行上传**：支持同时选择多个文件上传
- **多连接并行**：支持多个 SSH 客户端同时上传，单个客户端也可并行上传多个文件
- **上传队列管理**：
  - 实时进度显示
  - 任务状态跟踪（等待/上传中/成功/失败/已取消）
  - 支持取消、重试、编辑任务
  - 查看任务详情和执行日志
  - 批量开始/清除已完成任务
- 支持自定义远程文件名（解决中文文件名乱码问题）
- **前置/后置脚本**：
  - 可配置多个脚本模板
  - 上传时灵活选择执行哪些脚本
  - 支持临时脚本（一次性执行，不保存）
  - 脚本编辑器支持 Shell 语法高亮

## 界面布局

- **左侧面板**：SSH 连接列表 + 上传管理（Tab 切换）
- **右侧面板**：终端标签页
- 添加上传任务时自动切换到上传管理面板
- 日志面板可折叠，支持拖拽调整高度

## 数据存储

配置数据使用 SQLite 存储，路径：
```
~/.jtools/jtools-ssh-publisher/db.data
```

## 依赖

- Apache MINA SSHD (SSH/SFTP 客户端)
- SQLite JDBC (数据存储)
- JediTerm (终端模拟)
- IntelliJ Terminal Plugin

## 构建

```bash
./gradlew shadowJar
```

## 使用说明

### 添加 SSH 连接
1. 点击工具栏「新建配置」按钮
2. 填写连接名称、主机、端口、用户名
3. 选择认证方式：
   - **密码认证**：直接输入密码
   - **密钥认证**：粘贴私钥内容，可选填密钥密码
4. 设置默认远程目录（上传文件时的默认路径）
5. 可选配置前置/后置脚本模板
6. 点击「测试连接」验证配置

### 使用终端
- 双击 SSH 配置打开终端
- 支持多个终端同时打开
- 连接断开时显示提示，可点击重新连接

### 上传文件
1. 右键点击 SSH 配置，选择「上传文件」
2. 点击添加按钮选择一个或多个文件
3. 可修改远程文件名（避免中文乱码）
4. 选择需要执行的前置/后置脚本
5. 点击「添加到上传队列」
6. 切换到「上传管理」面板查看进度
7. 点击「全部开始」或单独启动任务

### 管理上传任务
- **开始**：启动等待中的任务
- **编辑**：修改文件路径、远程目录、脚本配置
- **详情**：查看任务完整信息和执行日志
- **取消**：取消正在上传的任务
- **移除**：从队列中移除任务

## License

MIT
